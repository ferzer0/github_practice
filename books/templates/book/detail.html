{% extends 'index.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" type="text/css" href="{% static 'css/main.css' %}">

<center><img src="{% static 'images/book.png' %}" width="200" height="200">
<div class="container">
    {{book.title}}</a><br>
    <p>by</p> {{book.author}} </center>
</div>
<br>
<div class="mx-auto" style="width: 600px;">
<center><h2>Add a new comment</h2></center>
    
    <hr>
    
    <form action="" method="POST">
        {% csrf_token %}
        {{comments.as_p}}
        <input type="submit" value="Comment" class="btn btn-primary">
    </form>
<br>
{% for commented in comment %}
<div class="mx-auto" style="width: 600px;">
<div class="comment">
  
  <p class="info" style="margin: 0;display: inline-block;">
    
    Commented by <b>{{ commented.author.first_name }} {{ commented.author.last_name }}</b>
    -  {{ commented.date_added }} </p>
    {% if commented.author == request.user %}

    
    <div class="modal" id="myModal">
      <div class="modal-dialog">
        <div class="modal-content">
        
          <!-- Modal Header -->
          <div class="modal-header">
            <h4 class="modal-title">Confirmation</h4>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
          </div>
          
          <!-- Modal body -->
          <div class="modal-body">
              Are you sure you want to delete this comment"
          </div>
          
          <!-- Modal footer -->
          <div class="modal-footer">
            <form method="POST" action="{% url 'book:delete_comment' commented.id %}">
              {% csrf_token %}
              <button type="submit" class="btn btn-danger"> Delete </button>
          </div>
          
        </div>
      </div>
    </div>
      
      </form>
    <div class="btn-group">
        <a href="" id="button_edit" data-toggle="modal" data-target="#myModal-2">
          Edit
        </a>
        <a href="" class="text-danger" id="button_edit" data-toggle="modal" data-target="#myModal">
          Delete
        </a>
    </div>
      <div class="modal" id="myModal-2">
        <div class="modal-dialog">
          <div class="modal-content">
          
            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Confirmation</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>
            
            <!-- Modal body -->
            <div class="modal-body">
                Are you sure you want to edit this comment?
            </div>
            
            <!-- Modal footer -->
            <div class="modal-footer">
                <a type="submit" class="btn btn-primary" href="{% url 'book:update_comment' commented.id %}"> confirm </a>
            </div>
            
          </div>
        </div>
      </div>
        

    </div>
    {% endif %}
  </p>
  {{ commented.content|linebreaks }}
</div>
</div>
{% empty %}
<p>There are no comments yet.</p>
{% endfor %}

{% endblock %}